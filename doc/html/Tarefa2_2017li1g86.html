<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa2_2017li1g86</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Tarefa2_2017li1g86.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>Jo&#227;o Pimentel &lt;a80874@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa2_2017li1g86</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo que implementa as fun&#231;&#245;es da <strong>Tarefa 2</strong> de <strong>Laborat&#243;rios de Inform&#225;tica 1</strong>.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:testesT2">testesT2</a> :: [<a href="LI11718.html#t:Tabuleiro">Tabuleiro</a>]</li><li class="src short"><a href="#v:m">m</a> :: <a href="LI11718.html#t:Mapa">Mapa</a></li><li class="src short"><a href="#v:m2">m2</a> :: <a href="LI11718.html#t:Mapa">Mapa</a></li><li class="src short"><a href="#v:m3">m3</a> :: <a href="LI11718.html#t:Mapa">Mapa</a></li><li class="src short"><a href="#v:m4">m4</a> :: <a href="LI11718.html#t:Mapa">Mapa</a></li><li class="src short"><a href="#v:tab">tab</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a></li><li class="src short"><a href="#v:trajeto">trajeto</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] -&gt; [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)]</li><li class="src short"><a href="#v:direction">direction</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] -&gt; [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)]</li><li class="src short"><a href="#v:same_ori">same_ori</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] -&gt; Bool</li><li class="src short"><a href="#v:avancar2">avancar2</a> :: (<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>) -&gt; <a href="LI11718.html#t:Posicao">Posicao</a></li><li class="src short"><a href="#v:position">position</a> :: (<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>) -&gt; <a href="LI11718.html#t:Posicao">Posicao</a></li><li class="src short"><a href="#v:ori">ori</a> :: (<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>) -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a></li><li class="src short"><a href="#v:posi">posi</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a> -&gt; <a href="LI11718.html#t:Peca">Peca</a></li><li class="src short"><a href="#v:posi2">posi2</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; <a href="LI11718.html#t:Peca">Peca</a></li><li class="src short"><a href="#v:find-39-">find'</a> :: [<a href="LI11718.html#t:Peca">Peca</a>] -&gt; Int -&gt; Int -&gt; <a href="LI11718.html#t:Peca">Peca</a></li><li class="src short"><a href="#v:tipo">tipo</a> :: <a href="LI11718.html#t:Peca">Peca</a> -&gt; <a href="LI11718.html#t:Tipo">Tipo</a></li><li class="src short"><a href="#v:valida_alturas">valida_alturas</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] -&gt; Int -&gt; Int -&gt; Bool</li><li class="src short"><a href="#v:soPecas">soPecas</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] -&gt; [<a href="LI11718.html#t:Peca">Peca</a>]</li><li class="src short"><a href="#v:hasnt_lava">hasnt_lava</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] -&gt; Bool</li><li class="src short"><a href="#v:alt_matrix">alt_matrix</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; Bool</li><li class="src short"><a href="#v:alt_line">alt_line</a> :: [<a href="LI11718.html#t:Peca">Peca</a>] -&gt; Bool</li><li class="src short"><a href="#v:put_lava">put_lava</a> :: [<a href="LI11718.html#t:Peca">Peca</a>] -&gt; Int -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; [<a href="LI11718.html#t:Peca">Peca</a>]</li><li class="src short"><a href="#v:puts">puts</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; [<a href="LI11718.html#t:Posicao">Posicao</a>] -&gt; <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a></li><li class="src short"><a href="#v:aux">aux</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; Int -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a></li><li class="src short"><a href="#v:just_posi">just_posi</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] -&gt; [<a href="LI11718.html#t:Posicao">Posicao</a>]</li><li class="src short"><a href="#v:new_pos">new_pos</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; <a href="LI11718.html#t:Mapa">Mapa</a></li><li class="src short"><a href="#v:avancar">avancar</a> :: <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a> -&gt; <a href="LI11718.html#t:Posicao">Posicao</a></li><li class="src short"><a href="#v:muda_esq">muda_esq</a> :: <a href="LI11718.html#t:Orientacao">Orientacao</a> -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a></li><li class="src short"><a href="#v:muda_dir">muda_dir</a> :: <a href="LI11718.html#t:Orientacao">Orientacao</a> -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a></li><li class="src short"><a href="#v:valida_lava">valida_lava</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; Bool</li><li class="src short"><a href="#v:aux2">aux2</a> :: [[<a href="LI11718.html#t:Peca">Peca</a>]] -&gt; Bool</li><li class="src short"><a href="#v:valida_retangulo">valida_retangulo</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; Bool</li><li class="src short"><a href="#v:valida">valida</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; Bool</li><li class="src short"><a href="#v:alt">alt</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] -&gt; Int</li><li class="src short"><a href="#v:first">first</a> :: (<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>) -&gt; <a href="LI11718.html#t:Peca">Peca</a></li><li class="src short"><a href="#v:aux4">aux4</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; Bool</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:testesT2" class="def">testesT2</a> :: [<a href="LI11718.html#t:Tabuleiro">Tabuleiro</a>] <a href="#v:testesT2" class="selflink">#</a></p><div class="doc"><p>testesT2 &#233; um lista de <code><a href="LI11718.html#t:Tabuleiro">Tabuleiro</a></code> definido por: [(tab m), (tab m2)]</p></div></div><div class="top"><p class="src"><a id="v:m" class="def">m</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> <a href="#v:m" class="selflink">#</a></p><div class="doc"><p>m &#233; um <code><a href="LI11718.html#t:Mapa">Mapa</a></code> definido por: Mapa ((2,1),Este) [[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Norte) 0,Peca Recta 0,Peca (Curva Este) 0,Peca Lava 0],[Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Oeste) 1,Peca Recta 1,Peca (Curva Sul) 1,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0]]</p></div></div><div class="top"><p class="src"><a id="v:m2" class="def">m2</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> <a href="#v:m2" class="selflink">#</a></p><div class="doc"><p>m2 &#233; um <code><a href="LI11718.html#t:Mapa">Mapa</a></code> definido por: Mapa ((2,1),Este) [[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Norte) 0,Peca Lava 1,Peca (Curva Este) 0,Peca Lava 0],[Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Oeste) 1,Peca Recta 1,Peca (Curva Sul) 1,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0]]</p></div></div><div class="top"><p class="src"><a id="v:m3" class="def">m3</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> <a href="#v:m3" class="selflink">#</a></p><div class="doc"><p>m3 &#233; um <code><a href="LI11718.html#t:Mapa">Mapa</a></code> definido por: Mapa ((4,1),Este) [[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Norte) 1,Peca (Rampa Oeste) 0,Peca Recta 0,Peca Recta 0,Peca (Curva Este) 0,Peca Lava 0],[Peca Lava 0,Peca Recta 1,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0],[Peca Lava 0,Peca (Rampa Sul) 1,Peca Lava 0,Peca (Curva Norte) 2,Peca (Rampa Oeste) 1,Peca (Curva Sul) 1,Peca Lava 0],[Peca Lava 0,Peca Recta 2,Peca Lava 0,Peca Recta 2,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Oeste) 2,Peca Recta 2,Peca (Curva Sul) 2,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0]]</p></div></div><div class="top"><p class="src"><a id="v:m4" class="def">m4</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> <a href="#v:m4" class="selflink">#</a></p><div class="doc"><p>m4 &#233; um <code><a href="LI11718.html#t:Mapa">Mapa</a></code> definido por: Mapa ((2,1),Este) [[Peca Lava 0,Peca Recta 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Norte) 0,Peca Recta 0,Peca (Curva Este) 0,Peca Lava 0],[Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Oeste) 1,Peca Recta 1,Peca (Curva Sul) 1,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0]]</p></div></div><div class="top"><p class="src"><a id="v:tab" class="def">tab</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> <a href="#v:tab" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:tab">tab</a></code> <strong>devolve</strong> o <em>Tabuleiro</em> de um <strong>Mapa</strong>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>tab m
</code></strong>[[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Norte) 0,Peca Recta 0,Peca (Curva Este) 0,Peca Lava 0],[Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Oeste) 1,Peca Recta 1,Peca (Curva Sul) 1,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0]]
</pre></div></div><div class="top"><p class="src"><a id="v:trajeto" class="def">trajeto</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] -&gt; [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] <a href="#v:trajeto" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:trajeto">trajeto</a></code> <strong>devolve</strong> uma <em>lista</em> de pares de <em>(Peca, Posicao)</em>,que contem a primeira passagem em cada pe&#231;a do trajeto, recebendo um <em>Mapa</em> e uma <em>lista</em> de pares de <em>(Peca, Posicao)</em>, que come&#231;a vazia.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>trajeto m []
</code></strong>[(Peca Recta 0,(2,1)),(Peca (Curva Este) 0,(3,1)),(Peca (Rampa Sul) 0,(3,2)),(Peca (Curva Sul) 1,(3,3)),(Peca Recta 1,(2,3)),(Peca (Curva Oeste) 1,(1,3)),(Peca (Rampa Sul) 0,(1,2)),(Peca (Curva Norte) 0,(1,1))]
</pre></div></div><div class="top"><p class="src"><a id="v:direction" class="def">direction</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] -&gt; [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] <a href="#v:direction" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:direction">direction</a></code> <strong>devolve</strong> uma <em>lista</em> de triplos de <em>(Peca, Posicao, Orientacao)</em>,que contem a primeira passagem em cada pe&#231;a do trajeto, recebendo um <em>Mapa</em> e uma <em>lista</em> de pares de <em>(Peca, Posicao, Orientacao)</em>, que come&#231;a vazia.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>direction m []
</code></strong>[(Peca Recta 0,(2,1),Este),(Peca (Curva Este) 0,(3,1),Este),(Peca (Rampa Sul) 0,(3,2),Sul),(Peca (Curva Sul) 1,(3,3),Sul),(Peca Recta 1,(2,3),Oeste),(Peca (Curva Oeste) 1,(1,3),Oeste),(Peca (Rampa Sul) 0,(1,2),Norte),(Peca (Curva Norte) 0,(1,1),Norte)]
</pre></div></div><div class="top"><p class="src"><a id="v:same_ori" class="def">same_ori</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] -&gt; Bool <a href="#v:same_ori" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:same_ori">same_ori</a></code> <strong>devolve</strong> um <em>Bool</em>, que depende do facto de a primeira pe&#231;a do percurso e a &#250;ltima terem a mesma orienta&#231;&#227;o. </p><p>Baseia-se no facto de a &#250;ltima pe&#231;a ir ter &#224; primeira, ou seja, completar o percurso.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>same_ori (direction m [])
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:avancar2" class="def">avancar2</a> :: (<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>) -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> <a href="#v:avancar2" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:avancar2">avancar2</a></code> <strong>devolve</strong> uma <em>Posicao</em> que &#233; obtida atrav&#233;s do avan&#231;o da posi&#231;&#227;o que recebe, consoante orienta&#231;&#227;o e tipo de Pe&#231;a.</p><p>Pode ter uma pe&#231;a do tipo <code><a href="LI11718.html#v:Lava">Lava</a></code>, que depois seria usada na fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:hasnt_lava">hasnt_lava</a></code>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>avancar2 (Peca Recta 0, (2,1), Este)
</code></strong>(3,1)
</pre></div></div><div class="top"><p class="src"><a id="v:position" class="def">position</a> :: (<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>) -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> <a href="#v:position" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:position">position</a></code> <strong>recebe</strong> um <em>triplo</em> de <em>(Peca, Posicao, Orientacao)</em> e devolve a sua <em>Posicao</em>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>position (Peca Recta 0, (2,1), Este)
</code></strong>(2,1)
</pre></div></div><div class="top"><p class="src"><a id="v:ori" class="def">ori</a> :: (<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>) -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a> <a href="#v:ori" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:ori">ori</a></code> <strong>recebe</strong> um <em>triplo</em> de <em>(Peca, Posicao, Orientacao)</em> e devolve a sua <em>Orientacao</em>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>position (Peca Recta 0, (2,1), Este)
</code></strong>Este
</pre></div></div><div class="top"><p class="src"><a id="v:posi" class="def">posi</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a> -&gt; <a href="LI11718.html#t:Peca">Peca</a> <a href="#v:posi" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:posi">posi</a></code> <strong>recebe</strong> um <em>Tabuleiro</em>, uma <em>Posicao</em> e uma <em>Orientacao</em> e devolve a <em>Peca</em> nessa posicao do <code><a href="LI11718.html#t:Tabuleiro">Tabuleiro</a></code>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>posi (tab m) (2,1) Este
</code></strong>Peca Recta 0
</pre></div></div><div class="top"><p class="src"><a id="v:posi2" class="def">posi2</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; <a href="LI11718.html#t:Peca">Peca</a> <a href="#v:posi2" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:posi2">posi2</a></code> <strong>recebe</strong> um <em>Tabuleiro</em> e uma <em>Posicao</em> e devolve a <em>Peca</em> nessa posicao do <code><a href="LI11718.html#t:Tabuleiro">Tabuleiro</a></code>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>posi2 (tab m) (3,1)
</code></strong>Peca (Curva Este) 0
</pre></div></div><div class="top"><p class="src"><a id="v:find-39-" class="def">find'</a> :: [<a href="LI11718.html#t:Peca">Peca</a>] -&gt; Int -&gt; Int -&gt; <a href="LI11718.html#t:Peca">Peca</a> <a href="#v:find-39-" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:find-39-">find'</a></code> <strong>recebe</strong> uma <em>lista</em> de Peca, ou seja, uma linha, e dois <em>Int</em>, sendo o primeiro a coluna que queremos e o segundo um contador. </p><p>Devolve a Peca existente na coluna pretendida.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>find' (head(tail (tab m))) 2 0
</code></strong>Peca Recta 0
</pre></div></div><div class="top"><p class="src"><a id="v:tipo" class="def">tipo</a> :: <a href="LI11718.html#t:Peca">Peca</a> -&gt; <a href="LI11718.html#t:Tipo">Tipo</a> <a href="#v:tipo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:tipo">tipo</a></code> <strong>recebe</strong> uma <em>Peca</em> e devolve o seu <em>Tipo</em>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>tipo (Peca Recta 0)
</code></strong>Recta
</pre></div></div><div class="top"><p class="src"><a id="v:valida_alturas" class="def">valida_alturas</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] -&gt; Int -&gt; Int -&gt; Bool <a href="#v:valida_alturas" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:valida_alturas">valida_alturas</a></code> <strong>recebe</strong> uma <em>lista</em> de triplos de <em>(Peca, Posicao, Orientacao)</em> e dois <em>Int</em>, o primeiro relativo &#224; altura inicial e o segundo serve para ir atualizando a altura, devolvendo um Bool consoante a veracidade das alturas.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valida_alturas (direction m []) 0 0
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:soPecas" class="def">soPecas</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] -&gt; [<a href="LI11718.html#t:Peca">Peca</a>] <a href="#v:soPecas" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code>so_pecas</code> <strong>recebe</strong> uma <em>lista</em> de pares de <em>(Peca, Posicao)</em> e devolve uma <em>lista</em> com, apenas, as <em>Peca</em>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>soPecas (trajeto m [])
</code></strong>[Peca Recta 0,Peca (Curva Este) 0,Peca (Rampa Sul) 0,Peca (Curva Sul) 1,Peca Recta 1,Peca (Curva Oeste) 1,Peca (Rampa Sul) 0,Peca (Curva Norte) 0]
</pre></div></div><div class="top"><p class="src"><a id="v:hasnt_lava" class="def">hasnt_lava</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] -&gt; Bool <a href="#v:hasnt_lava" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:hasnt_lava">hasnt_lava</a></code> <strong>recebe</strong> uma <em>lista</em> de pares de <em>(Peca, Posicao)</em> e devolve um Bool, consoante a exist&#234;ncia de pe&#231;as do tipo <em>Lava</em> na lista.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>hasnt_lava (trajeto m [])
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:alt_matrix" class="def">alt_matrix</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; Bool <a href="#v:alt_matrix" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:alt_matrix">alt_matrix</a></code> <strong>recebe</strong> um <em>Tabuleiro</em> e verifica se este &#233; s&#243; constitu&#237;do por pe&#231;as de Lava, com altura 0, devolvendo um Bool.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>alt_matrix (replicate 5 (replicate 5 (Peca Lava 0)))
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:alt_line" class="def">alt_line</a> :: [<a href="LI11718.html#t:Peca">Peca</a>] -&gt; Bool <a href="#v:alt_line" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:alt_line">alt_line</a></code> <strong>recebe</strong> uma <em>lista</em> de <em>Peca</em> e verifica se este &#233; s&#243; constitu&#237;do por pe&#231;as de Lava, com altura 0, devolvendo um Bool.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>alt_line (replicate 5 (Peca Lava 0))
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:put_lava" class="def">put_lava</a> :: [<a href="LI11718.html#t:Peca">Peca</a>] -&gt; Int -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; [<a href="LI11718.html#t:Peca">Peca</a>] <a href="#v:put_lava" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:put_lava">put_lava</a></code> <strong>recebe</strong> uma <em>lista</em> de <em>Peca</em>, um <em>Int</em> (contador) e uma <em>Posicao</em> e coloca na posicao pretendida uma peca de Lava, com altura 0.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>put_lava (replicate 5 (Peca Recta 0)) 0 (2,0)
</code></strong>[Peca Recta 0,Peca Recta 0,Peca Lava 0,Peca Recta 0,Peca Recta 0]
</pre></div></div><div class="top"><p class="src"><a id="v:puts" class="def">puts</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; [<a href="LI11718.html#t:Posicao">Posicao</a>] -&gt; <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> <a href="#v:puts" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:puts">puts</a></code> <strong>recebe</strong> um <em>Tabuleiro</em> e uma <em>lista</em> de <em>Posicao</em> e coloca nas posic&#245;es pretendida uma peca de Lava, com altura 0.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>puts (tab m) (just_posi (trajeto m []))
</code></strong>[[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0]]
</pre></div></div><div class="top"><p class="src"><a id="v:aux" class="def">aux</a> :: <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> -&gt; Int -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; <a href="LI11718.html#t:Tabuleiro">Tabuleiro</a> <a href="#v:aux" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:aux">aux</a></code> <strong>recebe</strong> um <em>Tabuleiro</em>, um <em>Int</em>, que serve como contador da linha, uma <em>Posicao</em> e descobre em qual linha do Tabuleiro vai chamar a fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:put_lava">put_lava</a></code>.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>aux (tab m) 0 (2,1)
</code></strong>[[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Norte) 0,Peca Lava 0,Peca (Curva Este) 0,Peca Lava 0],[Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Oeste) 1,Peca Recta 1,Peca (Curva Sul) 1,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0]]
</pre></div></div><div class="top"><p class="src"><a id="v:just_posi" class="def">just_posi</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>)] -&gt; [<a href="LI11718.html#t:Posicao">Posicao</a>] <a href="#v:just_posi" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:just_posi">just_posi</a></code> <strong>recebe</strong> uma <em>lista</em> de <em>(Peca, Posicao)</em> e devolve uma lista com apenas as posi&#231;&#245;es.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>just_posi (trajeto m [])
</code></strong>[(2,1),(3,1),(3,2),(3,3),(2,3),(1,3),(1,2),(1,1)]
</pre></div></div><div class="top"><p class="src"><a id="v:new_pos" class="def">new_pos</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; <a href="LI11718.html#t:Mapa">Mapa</a> <a href="#v:new_pos" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:new_pos">new_pos</a></code> <strong>recebe</strong> um <em>Mapa</em> e retorna outro <em>Mapa</em>, depois de avan&#231;ar uma posi&#231;&#227;o consoante a posi&#231;&#227;o inicial, pe&#231;a e orienta&#231;&#227;o.</p><p><strong>Exemplo:</strong></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>new_pos m
</code></strong>Mapa ((3,1),Este) [[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Norte) 0,Peca Recta 0,Peca (Curva Este) 0,Peca Lava 0],[Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0,Peca (Rampa Sul) 0,Peca Lava 0],[Peca Lava 0,Peca (Curva Oeste) 1,Peca Recta 1,Peca (Curva Sul) 1,Peca Lava 0],[Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0,Peca Lava 0]]
</pre></div></div><div class="top"><p class="src"><a id="v:avancar" class="def">avancar</a> :: <a href="LI11718.html#t:Posicao">Posicao</a> -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a> -&gt; <a href="LI11718.html#t:Posicao">Posicao</a> <a href="#v:avancar" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:avancar">avancar</a></code> &#233; utilizada na fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:aux">aux</a></code> e, recebendo uma Posicao e uma Orientacao, devolve a posicao para onde o carro se desloca em seguida. </p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>avancar (2,1) Este
</code></strong>(3,1)
</pre></div></div><div class="top"><p class="src"><a id="v:muda_esq" class="def">muda_esq</a> :: <a href="LI11718.html#t:Orientacao">Orientacao</a> -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a> <a href="#v:muda_esq" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:muda_esq">muda_esq</a></code> &#233; utilizada na fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:aux">aux</a></code> e, recebendo uma Orientacao, devolve a nova orienta&#231;&#227;o ap&#243;s uma curva &#224; esquerda. </p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>muda_esq Norte
</code></strong>Oeste
</pre></div></div><div class="top"><p class="src"><a id="v:muda_dir" class="def">muda_dir</a> :: <a href="LI11718.html#t:Orientacao">Orientacao</a> -&gt; <a href="LI11718.html#t:Orientacao">Orientacao</a> <a href="#v:muda_dir" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:muda_esq">muda_esq</a></code> &#233; utilizada na fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:aux">aux</a></code> e, recebendo uma Orientacao, devolve a nova orienta&#231;&#227;o ap&#243;s uma curva &#224; direita. </p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>muda_dir Norte
</code></strong>Este
</pre></div></div><div class="top"><p class="src"><a id="v:valida_lava" class="def">valida_lava</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; Bool <a href="#v:valida_lava" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:valida_lava">valida_lava</a></code> verifica se a moldura de um <em>Mapa</em> &#233; constitu&#237;da por pe&#231;as de Lava com altura 0.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valida_lava m
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:aux2" class="def">aux2</a> :: [[<a href="LI11718.html#t:Peca">Peca</a>]] -&gt; Bool <a href="#v:aux2" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:aux2">aux2</a></code> verifica se o primeiro e o &#250;ltimo elemento de cada linha da matriz &#233; do tipo <a href="Lava.html">Lava</a>, exceto da primeira e &#250;ltima linha. </p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>aux2 (tab m)
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:valida_retangulo" class="def">valida_retangulo</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; Bool <a href="#v:valida_retangulo" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:valida_retangulo">valida_retangulo</a></code> verifica se todas as linhas do <em>Mapa</em> t&#234;m o mesmo n&#250;mero de colunas.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valida_retangulo m
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:valida" class="def">valida</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; Bool <a href="#v:valida" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:valida">valida</a></code> verifica se um mapa &#233; v&#225;lido, usando todas as fun&#231;&#245;es de valid&#231;&#227;o presentes neste documento.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valida m2
</code></strong>False
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>valida m
</code></strong>True
</pre></div></div><div class="top"><p class="src"><a id="v:alt" class="def">alt</a> :: [(<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>)] -&gt; Int <a href="#v:alt" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:alt">alt</a></code> devolve a altura da peca na cabe&#231;a da lista de <em>(Peca, Posicao, Orientacao)</em>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>alt (direction  m [])
</code></strong>0
</pre></div></div><div class="top"><p class="src"><a id="v:first" class="def">first</a> :: (<a href="LI11718.html#t:Peca">Peca</a>, <a href="LI11718.html#t:Posicao">Posicao</a>, <a href="LI11718.html#t:Orientacao">Orientacao</a>) -&gt; <a href="LI11718.html#t:Peca">Peca</a> <a href="#v:first" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:first">first</a></code> devolve a <em>Peca</em> de um triplo <em>(Peca, Posicao, Orientacao)</em>.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>first (Peca (Rampa Sul) 0,(1,2),Norte)
</code></strong>Peca (Rampa Sul) 0
</pre></div></div><div class="top"><p class="src"><a id="v:aux4" class="def">aux4</a> :: <a href="LI11718.html#t:Mapa">Mapa</a> -&gt; Bool <a href="#v:aux4" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <code><a href="Tarefa2_2017li1g86.html#v:aux4">aux4</a></code> valida as alturas do percurso de um <em>Mapa</em>.</p><p>Tendo em considera&#231;&#227;o o caso especil em que come&#231;a numa descida.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>aux4 m
</code></strong>True
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.2</p></div></body></html>